# AIæ™ºèƒ½åŠ©æ‰‹å‰ç«¯ç•Œé¢è®¾è®¡æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•
- [æ•´ä½“è®¾è®¡ç†å¿µ](#æ•´ä½“è®¾è®¡ç†å¿µ)
- [é¡µé¢å¸ƒå±€è®¾è®¡](#é¡µé¢å¸ƒå±€è®¾è®¡)
- [ç»„ä»¶æ¶æ„](#ç»„ä»¶æ¶æ„)
- [äº¤äº’è®¾è®¡](#äº¤äº’è®¾è®¡)
- [æŠ€æœ¯å®ç°](#æŠ€æœ¯å®ç°)

---

## ğŸ¨ æ•´ä½“è®¾è®¡ç†å¿µ

### è®¾è®¡åŸåˆ™
1. **ç®€æ´ç›´è§‚** - ç±»ä¼¼å¾®ä¿¡èŠå¤©ç•Œé¢ï¼Œç”¨æˆ·é›¶å­¦ä¹ æˆæœ¬
2. **å“åº”å¼è®¾è®¡** - æ”¯æŒæ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
3. **æ™ºèƒ½å¼•å¯¼** - ä¸»åŠ¨æç¤ºç”¨æˆ·å¯ç”¨åŠŸèƒ½
4. **å¿«é€Ÿæ“ä½œ** - å¸¸ç”¨åŠŸèƒ½ä¸€é”®ç›´è¾¾
5. **è§†è§‰åé¦ˆ** - æ¸…æ™°çš„çŠ¶æ€æç¤ºå’ŒåŠ è½½åŠ¨ç”»

### è§†è§‰é£æ ¼
- **ä¸»è‰²è°ƒ**: è“è‰²ç³» (#409EFF) - ç§‘æŠ€æ„Ÿå’Œä¿¡ä»»æ„Ÿ
- **è¾…åŠ©è‰²**: ç»¿è‰² (#67C23A) - æˆåŠŸçŠ¶æ€ï¼Œç°è‰² (#909399) - æ¬¡è¦ä¿¡æ¯
- **å­—ä½“**: ç³»ç»Ÿé»˜è®¤å­—ä½“ï¼Œç¡®ä¿æ¸…æ™°åº¦
- **åœ†è§’**: 8px ç»Ÿä¸€åœ†è§’ï¼Œç°ä»£åŒ–è®¾è®¡
- **é˜´å½±**: è½»å¾®é˜´å½±å¢åŠ å±‚æ¬¡æ„Ÿ

---

## ğŸ“± é¡µé¢å¸ƒå±€è®¾è®¡

### æ•´ä½“å¸ƒå±€ç»“æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é¡¶éƒ¨å·¥å…·æ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¾§è¾¹æ     â”‚              ä¸»å¯¹è¯åŒºåŸŸ                     â”‚
â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  å¿«æ·åŠŸèƒ½  â”‚  â”‚           å¯¹è¯å†å²                   â”‚    â”‚
â”‚           â”‚  â”‚                                     â”‚    â”‚
â”‚  ä¼šè¯å†å²  â”‚  â”‚  [ç”¨æˆ·æ¶ˆæ¯]              [AIå›å¤]   â”‚    â”‚
â”‚           â”‚  â”‚                                     â”‚    â”‚
â”‚  æ™ºèƒ½æ¨è  â”‚  â”‚  [ç”¨æˆ·æ¶ˆæ¯]              [AIå›å¤]   â”‚    â”‚
â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚           â”‚  â”‚  è¾“å…¥æ¡† + å‘é€æŒ‰é’® + è¯­éŸ³æŒ‰é’®        â”‚    â”‚
â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å“åº”å¼é€‚é…
```css
/* æ¡Œé¢ç«¯ (>1200px) */
.ai-chat-container {
  display: grid;
  grid-template-columns: 280px 1fr;
  height: 100vh;
}

/* å¹³æ¿ç«¯ (768px-1200px) */
@media (max-width: 1200px) {
  .ai-chat-container {
    grid-template-columns: 240px 1fr;
  }
}

/* ç§»åŠ¨ç«¯ (<768px) */
@media (max-width: 768px) {
  .ai-chat-container {
    grid-template-columns: 1fr;
  }
  .sidebar {
    position: fixed;
    transform: translateX(-100%);
    transition: transform 0.3s ease;
  }
  .sidebar.open {
    transform: translateX(0);
  }
}
```

---

## ğŸ§© ç»„ä»¶æ¶æ„

### æ ¸å¿ƒç»„ä»¶ç»“æ„
```
AiChatPage.vue (ä¸»é¡µé¢)
â”œâ”€â”€ AiChatSidebar.vue (ä¾§è¾¹æ )
â”‚   â”œâ”€â”€ QuickActions.vue (å¿«æ·æ“ä½œ)
â”‚   â”œâ”€â”€ ChatHistory.vue (ä¼šè¯å†å²)
â”‚   â””â”€â”€ SmartSuggestions.vue (æ™ºèƒ½æ¨è)
â”œâ”€â”€ AiChatMain.vue (ä¸»å¯¹è¯åŒº)
â”‚   â”œâ”€â”€ ChatMessages.vue (æ¶ˆæ¯åˆ—è¡¨)
â”‚   â”‚   â”œâ”€â”€ UserMessage.vue (ç”¨æˆ·æ¶ˆæ¯)
â”‚   â”‚   â”œâ”€â”€ AiMessage.vue (AIå›å¤)
â”‚   â”‚   â””â”€â”€ SystemMessage.vue (ç³»ç»Ÿæ¶ˆæ¯)
â”‚   â””â”€â”€ ChatInput.vue (è¾“å…¥åŒºåŸŸ)
â”‚       â”œâ”€â”€ TextInput.vue (æ–‡æœ¬è¾“å…¥)
â”‚       â”œâ”€â”€ VoiceInput.vue (è¯­éŸ³è¾“å…¥)
â”‚       â””â”€â”€ QuickButtons.vue (å¿«æ·æŒ‰é’®)
â””â”€â”€ AiChatModals.vue (å¼¹çª—ç»„ä»¶)
    â”œâ”€â”€ SmartFormModal.vue (æ™ºèƒ½è¡¨å•)
    â”œâ”€â”€ ConfirmModal.vue (ç¡®è®¤å¯¹è¯æ¡†)
    â””â”€â”€ HelpModal.vue (å¸®åŠ©è¯´æ˜)
```

### çŠ¶æ€ç®¡ç†è®¾è®¡
```typescript
// stores/aiChat.ts
export const useAiChatStore = defineStore('aiChat', {
  state: () => ({
    // å½“å‰ä¼šè¯
    currentSession: {
      id: '',
      title: '',
      messages: [] as ChatMessage[],
      context: {} as ConversationContext
    },
    
    // ä¼šè¯å†å²
    sessionHistory: [] as ChatSession[],
    
    // UIçŠ¶æ€
    ui: {
      isLoading: false,
      isRecording: false,
      sidebarVisible: true,
      currentInput: '',
      suggestions: [] as string[]
    },
    
    // ç”¨æˆ·åå¥½
    preferences: {
      theme: 'light',
      voiceEnabled: true,
      autoSuggestions: true,
      messageSound: true
    }
  }),
  
  actions: {
    async sendMessage(content: string) {
      // å‘é€æ¶ˆæ¯é€»è¾‘
    },
    
    async loadChatHistory() {
      // åŠ è½½å†å²è®°å½•
    },
    
    updateUserPreferences(prefs: UserPreferences) {
      // æ›´æ–°ç”¨æˆ·åå¥½
    }
  }
})
```

---

## ğŸ¯ äº¤äº’è®¾è®¡

### 1. æ¶ˆæ¯è¾“å…¥äº¤äº’
```vue
<!-- ChatInput.vue -->
<template>
  <div class="chat-input-container">
    <!-- æ™ºèƒ½æç¤ºåŒºåŸŸ -->
    <div v-if="suggestions.length" class="suggestions-bar">
      <el-tag
        v-for="suggestion in suggestions"
        :key="suggestion"
        @click="applySuggestion(suggestion)"
        class="suggestion-tag"
      >
        {{ suggestion }}
      </el-tag>
    </div>
    
    <!-- è¾“å…¥åŒºåŸŸ -->
    <div class="input-area">
      <el-input
        v-model="inputText"
        type="textarea"
        :rows="1"
        :autosize="{ minRows: 1, maxRows: 4 }"
        placeholder="è¾“å…¥æ‚¨çš„é—®é¢˜ï¼Œæˆ–è¯´'å¸®åŠ©'æŸ¥çœ‹å¯ç”¨åŠŸèƒ½..."
        @keydown.enter.exact="handleSend"
        @keydown.ctrl.enter="addNewLine"
        @input="handleInputChange"
        class="message-input"
      />
      
      <!-- æ“ä½œæŒ‰é’®ç»„ -->
      <div class="action-buttons">
        <!-- è¯­éŸ³è¾“å…¥æŒ‰é’® -->
        <el-button
          :type="isRecording ? 'danger' : 'primary'"
          :icon="isRecording ? 'VideoCamera' : 'Microphone'"
          circle
          @click="toggleVoiceInput"
          :loading="isProcessingVoice"
        />
        
        <!-- å‘é€æŒ‰é’® -->
        <el-button
          type="primary"
          :icon="Send"
          @click="handleSend"
          :disabled="!inputText.trim() || isLoading"
          :loading="isLoading"
        >
          å‘é€
        </el-button>
      </div>
    </div>
    
    <!-- å¿«æ·æ“ä½œæŒ‰é’® -->
    <div class="quick-actions">
      <el-button-group>
        <el-button size="small" @click="insertQuickText('æŸ¥çœ‹ä»Šæ—¥é”€å”®')">
          ğŸ“Š ä»Šæ—¥é”€å”®
        </el-button>
        <el-button size="small" @click="insertQuickText('æ£€æŸ¥åº“å­˜é¢„è­¦')">
          âš ï¸ åº“å­˜é¢„è­¦
        </el-button>
        <el-button size="small" @click="insertQuickText('æ·»åŠ å•†å“')">
          â• æ·»åŠ å•†å“
        </el-button>
      </el-button-group>
    </div>
  </div>
</template>
```

### 2. æ¶ˆæ¯å±•ç¤ºäº¤äº’
```vue
<!-- AiMessage.vue -->
<template>
  <div class="ai-message">
    <div class="message-header">
      <el-avatar :size="32" src="/ai-avatar.png" />
      <span class="sender-name">AIåŠ©æ‰‹</span>
      <span class="timestamp">{{ formatTime(message.timestamp) }}</span>
    </div>
    
    <div class="message-content">
      <!-- æ–‡æœ¬å†…å®¹ -->
      <div v-if="message.type === 'text'" class="text-content">
        <div v-html="formatMessage(message.content)"></div>
      </div>
      
      <!-- æ•°æ®è¡¨æ ¼ -->
      <div v-else-if="message.type === 'table'" class="table-content">
        <el-table :data="message.data" size="small" stripe>
          <el-table-column
            v-for="column in message.columns"
            :key="column.prop"
            :prop="column.prop"
            :label="column.label"
            :width="column.width"
          />
        </el-table>
      </div>
      
      <!-- å›¾è¡¨å±•ç¤º -->
      <div v-else-if="message.type === 'chart'" class="chart-content">
        <div ref="chartContainer" class="chart-container"></div>
      </div>
      
      <!-- æ™ºèƒ½è¡¨å• -->
      <div v-else-if="message.type === 'form'" class="form-content">
        <SmartForm
          :schema="message.formSchema"
          @submit="handleFormSubmit"
          @cancel="handleFormCancel"
        />
      </div>
    </div>
    
    <!-- æ“ä½œæŒ‰é’® -->
    <div class="message-actions">
      <el-button-group size="small">
        <el-button @click="copyMessage" :icon="DocumentCopy">
          å¤åˆ¶
        </el-button>
        <el-button @click="regenerateResponse" :icon="Refresh">
          é‡æ–°ç”Ÿæˆ
        </el-button>
        <el-button @click="provideFeedback" :icon="ChatDotRound">
          åé¦ˆ
        </el-button>
      </el-button-group>
    </div>
  </div>
</template>
```

### 3. æ™ºèƒ½è¡¨å•äº¤äº’
```vue
<!-- SmartForm.vue -->
<template>
  <div class="smart-form">
    <el-form
      ref="formRef"
      :model="formData"
      :rules="formRules"
      label-width="100px"
    >
      <!-- åŠ¨æ€è¡¨å•å­—æ®µ -->
      <el-form-item
        v-for="field in schema.fields"
        :key="field.name"
        :label="field.label"
        :prop="field.name"
      >
        <!-- æ–‡æœ¬è¾“å…¥ -->
        <el-input
          v-if="field.type === 'text'"
          v-model="formData[field.name]"
          :placeholder="field.placeholder"
        />
        
        <!-- æ•°å­—è¾“å…¥ -->
        <el-input-number
          v-else-if="field.type === 'number'"
          v-model="formData[field.name]"
          :min="field.min"
          :max="field.max"
          :precision="field.precision"
        />
        
        <!-- é€‰æ‹©å™¨ -->
        <el-select
          v-else-if="field.type === 'select'"
          v-model="formData[field.name]"
          :placeholder="field.placeholder"
        >
          <el-option
            v-for="option in field.options"
            :key="option.value"
            :label="option.label"
            :value="option.value"
          />
        </el-select>
        
        <!-- æ—¥æœŸé€‰æ‹© -->
        <el-date-picker
          v-else-if="field.type === 'date'"
          v-model="formData[field.name]"
          type="date"
          :placeholder="field.placeholder"
        />
      </el-form-item>
      
      <!-- è¡¨å•æ“ä½œ -->
      <el-form-item>
        <el-button type="primary" @click="handleSubmit">
          {{ schema.submitText || 'ç¡®è®¤' }}
        </el-button>
        <el-button @click="handleCancel">
          å–æ¶ˆ
        </el-button>
      </el-form-item>
    </el-form>
  </div>
</template>
```

---

## ğŸ’» æŠ€æœ¯å®ç°

### 1. WebSocketè¿æ¥ç®¡ç†
```typescript
// composables/useWebSocket.ts
export function useWebSocket() {
  const socket = ref<WebSocket | null>(null)
  const isConnected = ref(false)
  const reconnectAttempts = ref(0)
  const maxReconnectAttempts = 5
  
  const connect = () => {
    try {
      socket.value = new WebSocket(WS_URL)
      
      socket.value.onopen = () => {
        isConnected.value = true
        reconnectAttempts.value = 0
        console.log('WebSocketè¿æ¥æˆåŠŸ')
      }
      
      socket.value.onmessage = (event) => {
        const message = JSON.parse(event.data)
        handleMessage(message)
      }
      
      socket.value.onclose = () => {
        isConnected.value = false
        handleReconnect()
      }
      
      socket.value.onerror = (error) => {
        console.error('WebSocketé”™è¯¯:', error)
      }
    } catch (error) {
      console.error('WebSocketè¿æ¥å¤±è´¥:', error)
    }
  }
  
  const handleReconnect = () => {
    if (reconnectAttempts.value < maxReconnectAttempts) {
      reconnectAttempts.value++
      setTimeout(() => {
        console.log(`å°è¯•é‡è¿ (${reconnectAttempts.value}/${maxReconnectAttempts})`)
        connect()
      }, 2000 * reconnectAttempts.value)
    }
  }
  
  const sendMessage = (message: any) => {
    if (socket.value && isConnected.value) {
      socket.value.send(JSON.stringify(message))
    }
  }
  
  return {
    isConnected: readonly(isConnected),
    connect,
    sendMessage
  }
}
```

### 2. è¯­éŸ³è¾“å…¥é›†æˆ
```typescript
// composables/useVoiceInput.ts
export function useVoiceInput() {
  const isRecording = ref(false)
  const isSupported = ref(false)
  const recognition = ref<SpeechRecognition | null>(null)
  
  onMounted(() => {
    // æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ
    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
      isSupported.value = true
      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition
      recognition.value = new SpeechRecognition()
      
      recognition.value.continuous = false
      recognition.value.interimResults = false
      recognition.value.lang = 'zh-CN'
      
      recognition.value.onresult = (event) => {
        const transcript = event.results[0][0].transcript
        onVoiceResult(transcript)
      }
      
      recognition.value.onerror = (event) => {
        console.error('è¯­éŸ³è¯†åˆ«é”™è¯¯:', event.error)
        isRecording.value = false
      }
      
      recognition.value.onend = () => {
        isRecording.value = false
      }
    }
  })
  
  const startRecording = () => {
    if (recognition.value && !isRecording.value) {
      isRecording.value = true
      recognition.value.start()
    }
  }
  
  const stopRecording = () => {
    if (recognition.value && isRecording.value) {
      recognition.value.stop()
    }
  }
  
  return {
    isSupported: readonly(isSupported),
    isRecording: readonly(isRecording),
    startRecording,
    stopRecording
  }
}
```

### 3. æ¶ˆæ¯æ¸²æŸ“ä¼˜åŒ–
```typescript
// composables/useMessageRenderer.ts
export function useMessageRenderer() {
  const formatMessage = (content: string) => {
    // Markdownæ¸²æŸ“
    let html = marked(content)
    
    // ä»£ç é«˜äº®
    html = html.replace(/<pre><code class="language-(\w+)">([\s\S]*?)<\/code><\/pre>/g, 
      (match, lang, code) => {
        return `<pre><code class="hljs language-${lang}">${hljs.highlight(code, {language: lang}).value}</code></pre>`
      })
    
    // è¡¨æƒ…ç¬¦å·
    html = html.replace(/:\w+:/g, (match) => {
      const emoji = emojiMap[match]
      return emoji || match
    })
    
    // é“¾æ¥å¤„ç†
    html = html.replace(/<a /g, '<a target="_blank" rel="noopener noreferrer" ')
    
    return html
  }
  
  const renderChart = (container: HTMLElement, data: ChartData) => {
    const chart = echarts.init(container)
    chart.setOption(data.options)
    
    // å“åº”å¼è°ƒæ•´
    const resizeObserver = new ResizeObserver(() => {
      chart.resize()
    })
    resizeObserver.observe(container)
    
    return chart
  }
  
  return {
    formatMessage,
    renderChart
  }
}
```

---

## ğŸ¨ æ ·å¼è®¾è®¡

### ä¸»é¢˜é…ç½®
```scss
// styles/ai-chat-theme.scss
:root {
  // ä¸»è‰²è°ƒ
  --ai-primary: #409EFF;
  --ai-primary-light: #79BBFF;
  --ai-primary-dark: #337ECC;

  // è¾…åŠ©è‰²
  --ai-success: #67C23A;
  --ai-warning: #E6A23C;
  --ai-danger: #F56C6C;
  --ai-info: #909399;

  // èƒŒæ™¯è‰²
  --ai-bg-primary: #FFFFFF;
  --ai-bg-secondary: #F5F7FA;
  --ai-bg-chat: #F8F9FA;

  // æ–‡å­—è‰²
  --ai-text-primary: #303133;
  --ai-text-regular: #606266;
  --ai-text-secondary: #909399;

  // è¾¹æ¡†è‰²
  --ai-border-light: #EBEEF5;
  --ai-border-base: #DCDFE6;

  // é˜´å½±
  --ai-shadow-light: 0 2px 12px 0 rgba(0, 0, 0, 0.1);
  --ai-shadow-base: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);
}

// æš—è‰²ä¸»é¢˜
[data-theme="dark"] {
  --ai-bg-primary: #1A1A1A;
  --ai-bg-secondary: #2D2D2D;
  --ai-bg-chat: #252525;
  --ai-text-primary: #E4E7ED;
  --ai-text-regular: #CFD3DC;
  --ai-text-secondary: #A4A9B0;
  --ai-border-light: #414243;
  --ai-border-base: #4C4D4F;
}
```

### ç»„ä»¶æ ·å¼
```scss
// èŠå¤©å®¹å™¨
.ai-chat-container {
  height: 100vh;
  background: var(--ai-bg-secondary);
  display: grid;
  grid-template-columns: 280px 1fr;

  .sidebar {
    background: var(--ai-bg-primary);
    border-right: 1px solid var(--ai-border-light);
    display: flex;
    flex-direction: column;

    .sidebar-header {
      padding: 16px;
      border-bottom: 1px solid var(--ai-border-light);

      h3 {
        margin: 0;
        color: var(--ai-text-primary);
        font-size: 16px;
        font-weight: 600;
      }
    }

    .sidebar-content {
      flex: 1;
      overflow-y: auto;
      padding: 8px;
    }
  }

  .main-chat {
    display: flex;
    flex-direction: column;
    background: var(--ai-bg-chat);

    .chat-header {
      padding: 16px 24px;
      background: var(--ai-bg-primary);
      border-bottom: 1px solid var(--ai-border-light);
      display: flex;
      align-items: center;
      justify-content: space-between;

      .session-info {
        display: flex;
        align-items: center;
        gap: 12px;

        .session-title {
          font-size: 16px;
          font-weight: 600;
          color: var(--ai-text-primary);
        }

        .session-status {
          padding: 2px 8px;
          border-radius: 12px;
          font-size: 12px;
          background: var(--ai-success);
          color: white;
        }
      }
    }

    .messages-container {
      flex: 1;
      overflow-y: auto;
      padding: 16px 24px;

      .message-group {
        margin-bottom: 24px;

        &.user-message {
          display: flex;
          justify-content: flex-end;

          .message-bubble {
            max-width: 70%;
            background: var(--ai-primary);
            color: white;
            padding: 12px 16px;
            border-radius: 18px 18px 4px 18px;
            box-shadow: var(--ai-shadow-light);
          }
        }

        &.ai-message {
          display: flex;
          justify-content: flex-start;
          align-items: flex-start;
          gap: 12px;

          .avatar {
            flex-shrink: 0;
            margin-top: 4px;
          }

          .message-content {
            max-width: 70%;
            background: var(--ai-bg-primary);
            padding: 12px 16px;
            border-radius: 18px 18px 18px 4px;
            box-shadow: var(--ai-shadow-light);
            border: 1px solid var(--ai-border-light);

            .typing-indicator {
              display: flex;
              align-items: center;
              gap: 4px;

              .dot {
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background: var(--ai-primary);
                animation: typing 1.4s infinite ease-in-out;

                &:nth-child(1) { animation-delay: -0.32s; }
                &:nth-child(2) { animation-delay: -0.16s; }
              }
            }
          }
        }
      }
    }

    .input-container {
      padding: 16px 24px;
      background: var(--ai-bg-primary);
      border-top: 1px solid var(--ai-border-light);
    }
  }
}

// åŠ¨ç”»æ•ˆæœ
@keyframes typing {
  0%, 80%, 100% {
    transform: scale(0);
    opacity: 0.5;
  }
  40% {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes slideInUp {
  from {
    transform: translateY(20px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.message-enter-active {
  animation: slideInUp 0.3s ease-out;
}
```

---

## ğŸ“± ç§»åŠ¨ç«¯é€‚é…

### å“åº”å¼å¸ƒå±€
```vue
<!-- AiChatPage.vue -->
<template>
  <div class="ai-chat-page" :class="{ 'mobile': isMobile }">
    <!-- ç§»åŠ¨ç«¯é¡¶éƒ¨å¯¼èˆª -->
    <div v-if="isMobile" class="mobile-header">
      <el-button
        :icon="Menu"
        @click="toggleSidebar"
        class="menu-button"
      />
      <h3 class="page-title">AIæ™ºèƒ½åŠ©æ‰‹</h3>
      <el-button
        :icon="Setting"
        @click="showSettings"
        class="settings-button"
      />
    </div>

    <!-- ä¾§è¾¹æ é®ç½© -->
    <div
      v-if="isMobile && sidebarVisible"
      class="sidebar-overlay"
      @click="closeSidebar"
    />

    <!-- ä¸»è¦å†…å®¹åŒºåŸŸ -->
    <div class="chat-container">
      <AiChatSidebar
        :class="{ 'mobile-sidebar': isMobile }"
        :visible="sidebarVisible"
        @close="closeSidebar"
      />

      <AiChatMain class="chat-main" />
    </div>

    <!-- ç§»åŠ¨ç«¯åº•éƒ¨è¾“å…¥æ  -->
    <div v-if="isMobile" class="mobile-input-bar">
      <ChatInput @send="handleSend" />
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted, onUnmounted } from 'vue'
import { useWindowSize } from '@vueuse/core'

const { width } = useWindowSize()
const isMobile = computed(() => width.value < 768)
const sidebarVisible = ref(false)

const toggleSidebar = () => {
  sidebarVisible.value = !sidebarVisible.value
}

const closeSidebar = () => {
  sidebarVisible.value = false
}

// ç§»åŠ¨ç«¯è‡ªåŠ¨éšè—ä¾§è¾¹æ 
watch(isMobile, (newVal) => {
  if (newVal) {
    sidebarVisible.value = false
  } else {
    sidebarVisible.value = true
  }
}, { immediate: true })
</script>
```

### è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ
```typescript
// composables/useTouch.ts
export function useTouch() {
  const startX = ref(0)
  const startY = ref(0)
  const currentX = ref(0)
  const currentY = ref(0)

  const onTouchStart = (event: TouchEvent) => {
    const touch = event.touches[0]
    startX.value = touch.clientX
    startY.value = touch.clientY
  }

  const onTouchMove = (event: TouchEvent) => {
    const touch = event.touches[0]
    currentX.value = touch.clientX
    currentY.value = touch.clientY
  }

  const onTouchEnd = () => {
    const deltaX = currentX.value - startX.value
    const deltaY = currentY.value - startY.value

    // æ°´å¹³æ»‘åŠ¨æ£€æµ‹
    if (Math.abs(deltaX) > Math.abs(deltaY) && Math.abs(deltaX) > 50) {
      if (deltaX > 0) {
        // å‘å³æ»‘åŠ¨ - æ‰“å¼€ä¾§è¾¹æ 
        emit('swipeRight')
      } else {
        // å‘å·¦æ»‘åŠ¨ - å…³é—­ä¾§è¾¹æ 
        emit('swipeLeft')
      }
    }
  }

  return {
    onTouchStart,
    onTouchMove,
    onTouchEnd
  }
}
```

---

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–

### è™šæ‹Ÿæ»šåŠ¨
```vue
<!-- VirtualMessageList.vue -->
<template>
  <div
    ref="containerRef"
    class="virtual-list-container"
    @scroll="handleScroll"
  >
    <div
      class="virtual-list-phantom"
      :style="{ height: totalHeight + 'px' }"
    />

    <div
      class="virtual-list-content"
      :style="{ transform: `translateY(${offsetY}px)` }"
    >
      <div
        v-for="item in visibleItems"
        :key="item.id"
        class="virtual-list-item"
        :style="{ height: itemHeight + 'px' }"
      >
        <ChatMessage :message="item" />
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, onMounted, nextTick } from 'vue'

const props = defineProps<{
  messages: ChatMessage[]
  itemHeight: number
}>()

const containerRef = ref<HTMLElement>()
const scrollTop = ref(0)
const containerHeight = ref(0)

// è®¡ç®—å¯è§åŒºåŸŸ
const visibleCount = computed(() =>
  Math.ceil(containerHeight.value / props.itemHeight) + 2
)

const startIndex = computed(() =>
  Math.floor(scrollTop.value / props.itemHeight)
)

const endIndex = computed(() =>
  Math.min(startIndex.value + visibleCount.value, props.messages.length)
)

const visibleItems = computed(() =>
  props.messages.slice(startIndex.value, endIndex.value)
)

const totalHeight = computed(() =>
  props.messages.length * props.itemHeight
)

const offsetY = computed(() =>
  startIndex.value * props.itemHeight
)

const handleScroll = (event: Event) => {
  scrollTop.value = (event.target as HTMLElement).scrollTop
}

onMounted(() => {
  if (containerRef.value) {
    containerHeight.value = containerRef.value.clientHeight
  }
})
</script>
```

### æ¶ˆæ¯ç¼“å­˜ç­–ç•¥
```typescript
// utils/messageCache.ts
class MessageCache {
  private cache = new Map<string, ChatMessage[]>()
  private maxSize = 50 // æœ€å¤§ç¼“å­˜ä¼šè¯æ•°

  get(sessionId: string): ChatMessage[] | undefined {
    return this.cache.get(sessionId)
  }

  set(sessionId: string, messages: ChatMessage[]): void {
    // LRUç­–ç•¥ï¼šå¦‚æœè¶…å‡ºæœ€å¤§ç¼“å­˜æ•°ï¼Œåˆ é™¤æœ€æ—§çš„
    if (this.cache.size >= this.maxSize) {
      const firstKey = this.cache.keys().next().value
      this.cache.delete(firstKey)
    }

    this.cache.set(sessionId, messages)
  }

  clear(): void {
    this.cache.clear()
  }

  // é¢„åŠ è½½ç›¸é‚»ä¼šè¯
  preload(sessionIds: string[]): void {
    sessionIds.forEach(id => {
      if (!this.cache.has(id)) {
        // å¼‚æ­¥åŠ è½½æ¶ˆæ¯
        this.loadMessages(id)
      }
    })
  }

  private async loadMessages(sessionId: string): Promise<void> {
    try {
      const messages = await api.getChatHistory(sessionId)
      this.set(sessionId, messages)
    } catch (error) {
      console.error('é¢„åŠ è½½æ¶ˆæ¯å¤±è´¥:', error)
    }
  }
}

export const messageCache = new MessageCache()
```

---

## ğŸ§ª ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### æ™ºèƒ½è¾“å…¥å»ºè®®
```typescript
// composables/useSmartSuggestions.ts
export function useSmartSuggestions() {
  const suggestions = ref<string[]>([])
  const isLoading = ref(false)

  // åŸºäºç”¨æˆ·è¾“å…¥çš„æ™ºèƒ½å»ºè®®
  const getSuggestions = useDebounceFn(async (input: string) => {
    if (input.length < 2) {
      suggestions.value = []
      return
    }

    isLoading.value = true

    try {
      // æœ¬åœ°å¿«é€ŸåŒ¹é…
      const localSuggestions = getLocalSuggestions(input)

      // AIæ™ºèƒ½å»ºè®®
      const aiSuggestions = await api.getSmartSuggestions(input)

      // åˆå¹¶å¹¶å»é‡
      suggestions.value = [...new Set([...localSuggestions, ...aiSuggestions])]
        .slice(0, 5) // æœ€å¤šæ˜¾ç¤º5ä¸ªå»ºè®®

    } catch (error) {
      console.error('è·å–å»ºè®®å¤±è´¥:', error)
      suggestions.value = getLocalSuggestions(input)
    } finally {
      isLoading.value = false
    }
  }, 300)

  const getLocalSuggestions = (input: string): string[] => {
    const commonQueries = [
      'æŸ¥çœ‹ä»Šæ—¥é”€å”®æƒ…å†µ',
      'æ£€æŸ¥åº“å­˜é¢„è­¦',
      'æ·»åŠ æ–°å•†å“',
      'æŸ¥è¯¢å•†å“ä¿¡æ¯',
      'åˆ†æé”€å”®è¶‹åŠ¿',
      'ç”Ÿæˆè´¢åŠ¡æŠ¥è¡¨',
      'è®¾ç½®ä¿ƒé”€æ´»åŠ¨',
      'ç®¡ç†ä¾›åº”å•†ä¿¡æ¯'
    ]

    return commonQueries.filter(query =>
      query.toLowerCase().includes(input.toLowerCase())
    )
  }

  return {
    suggestions: readonly(suggestions),
    isLoading: readonly(isLoading),
    getSuggestions
  }
}
```

### é”™è¯¯å¤„ç†ä¸é‡è¯•
```vue
<!-- ErrorBoundary.vue -->
<template>
  <div class="error-boundary">
    <div v-if="hasError" class="error-content">
      <el-result
        icon="warning"
        title="å‡ºç°äº†ä¸€äº›é—®é¢˜"
        :sub-title="errorMessage"
      >
        <template #extra>
          <el-button type="primary" @click="retry">
            é‡è¯•
          </el-button>
          <el-button @click="reportError">
            æŠ¥å‘Šé—®é¢˜
          </el-button>
        </template>
      </el-result>
    </div>

    <slot v-else />
  </div>
</template>

<script setup lang="ts">
import { ref, onErrorCaptured } from 'vue'

const hasError = ref(false)
const errorMessage = ref('')
const originalError = ref<Error | null>(null)

onErrorCaptured((error: Error) => {
  hasError.value = true
  errorMessage.value = error.message || 'æœªçŸ¥é”™è¯¯'
  originalError.value = error

  // é”™è¯¯ä¸ŠæŠ¥
  console.error('ç»„ä»¶é”™è¯¯:', error)

  return false // é˜»æ­¢é”™è¯¯ç»§ç»­ä¼ æ’­
})

const retry = () => {
  hasError.value = false
  errorMessage.value = ''
  originalError.value = null

  // è§¦å‘é‡æ–°æ¸²æŸ“
  nextTick(() => {
    // é‡æ–°åŠ è½½æ•°æ®æˆ–é‡ç½®çŠ¶æ€
  })
}

const reportError = () => {
  // å‘é€é”™è¯¯æŠ¥å‘Š
  if (originalError.value) {
    api.reportError({
      message: originalError.value.message,
      stack: originalError.value.stack,
      userAgent: navigator.userAgent,
      timestamp: new Date().toISOString()
    })
  }

  ElMessage.success('é”™è¯¯æŠ¥å‘Šå·²å‘é€ï¼Œæ„Ÿè°¢æ‚¨çš„åé¦ˆï¼')
}
</script>
```

---

*æœ¬æ–‡æ¡£æä¾›äº†å®Œæ•´çš„AIå‰ç«¯ç•Œé¢è®¾è®¡æ–¹æ¡ˆï¼Œæ¶µç›–äº†å¸ƒå±€ã€ç»„ä»¶ã€äº¤äº’ã€æ ·å¼ã€æ€§èƒ½ä¼˜åŒ–ç­‰å„ä¸ªæ–¹é¢*
```

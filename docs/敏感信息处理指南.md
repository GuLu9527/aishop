# 敏感信息处理指南

## 1. 配置文件管理

### 1.1 环境变量
所有敏感信息都应通过环境变量注入，包括但不限于：
- 数据库连接信息
- API密钥
- 加密密钥
- 认证凭据

### 1.2 配置文件分类
- `application.yml`: 基础配置，使用环境变量占位符
- `application-{env}.yml`: 环境特定配置，**不要**提交到代码仓库
- `.env`: 本地环境变量文件，**不要**提交到代码仓库
- `.env.example`: 环境变量模板，可以提交到代码仓库

## 2. 需要保护的信息

### 2.1 数据库相关
- 数据库用户名
- 数据库密码
- 数据库连接URL中的敏感信息
- Redis密码
- 其他数据库连接凭据

### 2.2 API密钥
- 阿里云AccessKey/SecretKey
- 通义千问API密钥
- 其他第三方服务API密钥

### 2.3 JWT相关
- JWT签名密钥
- Token加密密钥

### 2.4 支付相关
- 支付宝密钥对
- 微信支付密钥
- 商户证书
- 其他支付凭据

### 2.5 其他敏感信息
- 系统管理员密码
- 加密密钥
- 服务器凭据
- 监控系统凭据

## 3. 配置文件处理

### 3.1 本地开发
1. 复制 `.env.example` 到 `.env`
2. 在 `.env` 中填入实际的配置值
3. 确保 `.env` 已在 `.gitignore` 中

### 3.2 生产环境
1. 使用环境变量或配置管理系统
2. 避免在容器镜像中包含敏感信息
3. 使用密钥管理服务

## 4. 代码仓库清理

### 4.1 需要从仓库中删除的文件
```
# 配置文件
application-dev.yml
application-prod.yml
application-test.yml
.env
*.properties（包含敏感信息）

# 密钥文件
*.key
*.pem
*.p12
*.pfx
*.jks
*.keystore

# 日志文件
*.log
```

### 4.2 `.gitignore` 规则
```gitignore
### 环境配置文件 ###
.env
.env.*
!.env.example

### 应用配置 ###
**/application-*.yml
!**/application.yml

### 密钥文件 ###
*.key
*.pem
*.p12
*.pfx
*.jks
*.keystore

### 日志文件 ###
logs/
*.log
*.log.*
```

## 5. 安全最佳实践

### 5.1 开发过程
- 使用环境变量而不是硬编码
- 定期轮换密钥和凭据
- 使用加密算法保护敏感数据
- 实现审计日志

### 5.2 部署过程
- 使用配置管理服务
- 实施最小权限原则
- 加密传输所有敏感数据
- 监控异常访问

### 5.3 代码审查
- 检查敏感信息泄露
- 验证配置文件安全性
- 确认加密实现正确性
- 审查权限控制
